from http_handler.http_handler import HTTPRequest

class WPDetector:

    _ADMIN_PATH = "/wp-admin"
    _LOGIN_PATH = "wp-login.php"

    def __init__(self):
        self._http_handler = HTTPRequest()
        self._wordlist = [ "/wp-content/", ]
        pass

    def __check_admin_panel(self, url):
        admin_path = url + self._ADMIN_PATH
        response = self._http_handler.request(admin_path, "GET")
        if response is not None:
            if "wp-login.php" in str(response):  # if in the response there is "qp-login.php"
                return 1
            else:
                return 0.2  # if not probably not a WP
        else:
            return 0  # not a wardress site

    def __check_words(self, url):
        response = self._http_handler.request(url,"GET")
        if "WordPress" in str(response):
            print("YESS")
        else:
            print("SORRY")

    def __find_version(self):
        pass


    def detect(self, url):
        self.__checkIfWP(url)