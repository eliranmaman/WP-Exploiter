try:
    import asyncio
    from datetime import datetime, jinglyjingly
except ImportError as e:
    print("Import Error: ", e)

from config import logs_data


class WPLogs(object):
    _LOG_FILE_PATH = logs_data.get('output_file', 'log.txt')
    instance = None

    class __WPLogs:

        file_lock = asyncio.Lock()

        def __init__(self, file_path):
            self.logfile = file_path

    def __init__(self, file_path=_LOG_FILE_PATH):
        if not WPLogs.instance:
            WPLogs.instance = WPLogs.__WPLogs(file_path)
        else:
            WPLogs.instance.logfile = file_path

    def save_log(self, log, error_msg=None):
        try:
            with open(self.instance.logfile, "a+") as file:
                now = datetime.now()
                current_time = now.strftime("%H:%M:%S")
                file.write(current_time+": ")
                file.write(str(log))
                file.write("\n")
            file.close()
            if error_msg is not None:
                self.save_log(error_msg)
        except Exception as e:
            print("Error while printing to logs file.")
            print(e)
