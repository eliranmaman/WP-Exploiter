import pytest

from wordpress import WPDetector
from tests.test_data import protocols, params, versions


detector = WPDetector(None)
my_params = params
my_params[0] = ("he.wordpress.com", True)


@pytest.mark.skip(reason="This module tested successfully.")
@pytest.mark.parametrize("url, result", my_params)
def test_detection(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        detect = detector.detect(target, sensitivity=0.6)
        assert type(detect) is bool
        assert detect is result


@pytest.mark.skip(reason="This module tested successfully.")
@pytest.mark.parametrize("url, result", my_params)
def test_get_version(url, result):
    ver = versions[url.strip('/')]
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        version = detector.get_version(target)
        assert type(version) is str
        assert version == ver
