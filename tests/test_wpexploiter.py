import time
import pytest
import random

from wordpress import WPDatabaseResetExploiter
from tests.test_data import protocols, params


@pytest.mark.parametrize("url, result", params)
def test_database_exploiter_is_vulnerable(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        exploiter = WPDatabaseResetExploiter(target)
        is_vulnerable = exploiter.is_vulnerable()
        assert type(is_vulnerable) is bool
        assert  is_vulnerable == result