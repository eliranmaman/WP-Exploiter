import pytest

from wordpress import WPDatabaseResetExploiter
from tests.test_data import protocols, params

params[2] = ("elro-sec.com/dev2", False)
params[3] = ("elro-sec.com/dev3", False)


@pytest.mark.parametrize("url, result", params)
def test_database_exploiter_is_vulnerable(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        exploiter = WPDatabaseResetExploiter(target)
        is_vulnerable = exploiter.is_vulnerable()
        assert type(is_vulnerable) is bool
        assert is_vulnerable == result


@pytest.mark.parametrize("url, result", params)
def test_database_exploiter_is_vulnerable(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        exploiter = WPDatabaseResetExploiter(target)
        is_vulnerable = exploiter.is_vulnerable()
        assert type(is_vulnerable) is bool
        assert is_vulnerable == result