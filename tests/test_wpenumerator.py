import pytest

from wordpress import WPEnumerator
from tests.test_data import protocols, params, proxies


params[0] = ("he.wordpress.com", False)
params[3] = ("elro-sec.com/dev3/", False)


@pytest.mark.skip(reason="This module tested successfully.")
@pytest.mark.parametrize("url, result", params)
def test_enumeration_possible(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        enumerator = WPEnumerator(target, proxies=proxies)
        is_possible = enumerator.is_enumeration_possible()
        assert type(is_possible) is bool
        assert is_possible is result


@pytest.mark.skip(reason="This module tested successfully.")
@pytest.mark.parametrize("url, result", params)
def test_enumeration(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        enumerator = WPEnumerator(target)
        users = enumerator.enumerate()
        assert type(users) is dict
        size = len(users) > 0
        assert size is result
