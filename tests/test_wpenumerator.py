import pytest

from wordpress import WPEnumerator
from tests.test_data import protocols, params, proxies

params[3] = ("elro-sec.com/dev3/", False)


@pytest.mark.parametrize("url, result", params)
def test_enumeration_possible(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        enumerator = WPEnumerator(target, proxies=proxies)
        is_possible = enumerator.is_enumeration_possible()
        assert type(is_possible) is bool
        assert is_possible is result


@pytest.mark.parametrize("url, result", params)
def test_enumeration(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        enumerator = WPEnumerator(target)
        users = enumerator.enumerate()
        size = len(users) > 0
        if not size:
            assert type(users) is None
        else:
            assert type(users) is dict
            assert size is result
