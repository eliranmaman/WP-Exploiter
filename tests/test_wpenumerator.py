import pytest

from wordpress import WPEnumerator
from tests.test_data import protocols, params


params[0] = ("he.wordpress.com", True)


@pytest.mark.parametrize("url, result", params)
def test_enumeration_possible(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        enumerator = WPEnumerator(target)
        is_possible = enumerator.is_enumeration_possible()
        assert type(is_possible) is bool
        assert is_possible is result


@pytest.mark.parametrize("url, result", params)
def test_enumeration(url, result):
    for protocol in protocols:
        target = "{}{}".format(protocol, url)
        enumerator = WPEnumerator(target)
        users = enumerator.enumerate()
        assert type(users) is dict
        size = len(users) > 0
        if 'he.wordpress' in url:
            size = True
        assert size is result
